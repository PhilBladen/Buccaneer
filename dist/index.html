<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" id="viewport" content="width=device-width, initial-scale=1" />
    <title>Buccaneer</title>

    <link rel="stylesheet" href="style.css">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.7/css/all.css">
    <link rel="manifest" href="manifest.webmanifest">

    <script src="https://code.jquery.com/pep/0.4.3/pep.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        function isOverflown(element) {
            return element.scrollHeight > element.clientHeight || element.scrollWidth > element.clientWidth;
        }

        let numCards = 7;
        setInterval(() => {
            let c = $("#c1");
            let cards = $("#cs");

            // if (isOverflown(cards[0])) {
            // console.log("Overflowing");

            let element = cards[0];
            let aspect = 600 / 394;
            let defaultCardWidth = 200 / aspect;
            let scaleFactor = Math.min(1, element.clientWidth / (defaultCardWidth * (1 + 0.25 * (numCards - 1))));
            let cw = scaleFactor * defaultCardWidth;
            var elements = document.querySelectorAll('.card');
            for (var i = 0; i < elements.length; i++) {
                elements[i].style.width = cw + "px";
            }

            elements = document.querySelectorAll('.cardimg');
            for (var i = 0; i < elements.length; i++) {
                elements[i].style.minWidth = (cw * 0.25) + "px";
                // elements[i].style.height = (cw * aspect) + "px";
            }

            // console.log((element.clientWidth / element.scrollWidth) * (200 / aspect));
            // }



            if (numCards < 52) {
                numCards++;
                cards.append(c.clone(true, true));
            }
        }, 100);

        window.onresize = () => {
            let c = $("#c1");
            let cards = $("#cs");

            // if (isOverflown(cards[0])) {
            console.log("Overflowing");

            let element = cards[0];
            let aspect = 600 / 394;
            let defaultCardWidth = 200 / aspect;
            let scaleFactor = Math.min(1, element.clientWidth / (defaultCardWidth * (1 + 0.25 * (numCards - 1))));
            let cw = scaleFactor * defaultCardWidth;
            var elements = document.querySelectorAll('.card');
            for (var i = 0; i < elements.length; i++) {
                elements[i].style.width = cw + "px";
            }

            elements = document.querySelectorAll('.cardimg');
            for (var i = 0; i < elements.length; i++) {
                elements[i].style.minWidth = (cw * 0.25) + "px";
            }
        }
    </script>
</head>

<body>
    <canvas id="renderCanvas" class="" touch-action="none"></canvas>

    <!-- <div id="cards" class=" " style="position: fixed; width: 100%; left: 0; bottom: 0; pointer-events: none; ">
        <div id="cards " class="container " style="max-width: 50%; height: 300px; margin-left: auto; margin-right: auto; bottom: 0; flex-direction: row; justify-content: space-evenly; ">
            <div class="container cards " style="flex-direction: row; ">
                <div class="card ">
                    <img src="assets/pirates/Pirate Black 1 NoWear.png " alt=" ">
                </div>
                <div class="card ">
                    <img src="assets/pirates/Pirate Black 1 NoWear.png " alt=" ">
                </div>
                <div class="card ">
                    <img src="assets/pirates/Pirate Black 3 NoWear.png " alt=" ">
                </div>
            </div>

            <div class="container cards " style="flex-direction: row; ">
                <div class="card ">
                    <img src="assets/pirates/Pirate Red 1 NoWear.png " alt=" ">
                </div>
                <div class="card ">
                    <img src="assets/pirates/Pirate Red 2 NoWear.png " alt=" ">
                </div>
                <div class="card ">
                    <img src="assets/pirates/Pirate Red 3 NoWear.png " alt=" ">
                </div>
                <div class="card ">
                    <img src="assets/pirates/Pirate Red 3 NoWear.png " alt=" ">
                </div>
            </div>
        </div>
    </div> -->

    <!-- Whole HUD -->
    <div id="hud" class="column" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0; pointer-events: none; overflow: hidden;">

        <!-- Top of screen HUD -->
        <div id="hudtop" class="container clickable" style="flex: 0 0 auto;">
            <div class="" style="flex: 1 1 200px;">
                <i id="settings" class="fa fa-caret-square-down menubtn" style="padding-left: 5px;"></i>
                <i id="debug" class="fa fa-bug menubtn"></i>
                <!-- <i id="settings" class="fa fa-cog menubtn"></i> -->
            </div>
            <div id="currentturnportname" class="" style="flex: 1 0; text-align: center; min-width: fit-content;">
                Cadiz's Move
            </div>
            <div id="fps" class="" style="min-width: fit-content; flex: 1 1 200px; text-align: right; padding-right: 10px;">

            </div>
        </div>

        <div class="container" style="flex: 1 1 auto; ">
        </div>

        <!-- Bottom HUD -->
        <div id="hudbottom" class="container" style="flex: 0 0 auto; flex-direction: row; align-items: flex-end; transition: transform ease-in-out 0.3s;">

            <!-- City HUD -->
            <div class="container" style="flex: 1 1;">
                <div id="hudleft" class="column hudleft clickable" style="z-index: 1; flex: 0 1 auto; background-color: #6A9023;">

                    <div id="cityname" class="city" style="flex: 1 1 auto;">BOMBAY</div>

                    <!-- Boat + pirate count UI -->
                    <div class="grid testgrid" style="flex: 1 1 auto; flex-direction: row;">

                        <!-- Boat -->
                        <div class="boatcell container">
                            <div class="row" style="justify-content: center; align-items: center; grid-column: 1 / span 2; min-width: fit-content;">
                                <div style="position: absolute;" class="row">
                                    <div class="treasure container">
                                        <img src="assets/icon-barrel.png">
                                    </div>
                                    <div class="treasure container" style="margin-left: 10px;">
                                        <img src="assets/icon-gold.png">
                                    </div>
                                </div>
                                <img src="assets/BoatIcon.png" alt="" class="boat">
                            </div>
                        </div>


                        <!-- Pirate count + fighting strength -->
                        <div id="btnpiratecards" class="column dummycell cellbtn" style="align-items: stretch; padding-top: 0; padding-bottom: 0;">
                            <div class="row" style="flex: 1; align-items: center; padding-left: 0px;">
                                <img src="assets/PirateIcon.png" alt="" class="buccaneer icon" style="height: 48px">
                                <div style="flex: 1"></div>
                                <div id="sailingstrength" class="cardcount">14</div>
                            </div>

                            <div class="row" style="flex: 1 1; align-items: center; padding-left: 0px;">
                                <img src="assets/FightingIcon.png" alt="" class="buccaneer icon" style="height: 48px">
                                <div style="flex: 1"></div>
                                <div id="fightingstrength" class="cardcount">8</div>
                            </div>
                        </div>

                        <!-- Rules + card button UI -->
                        <div id="btnrules" class="dummycell container cellbtn" style="justify-content: center; align-items: center; ">
                            <img src="assets/RulesIcon.png" alt=" " class="buccaneer icon ">
                        </div>
                        <div id="btnhome" class="dummycell container cellbtn" style="justify-content: center; align-items: center; ">
                            <img src="assets/CamHomeIcon.png" alt=" " class="buccaneer icon ">
                        </div>
                        <div id="btncameralockboat" class="dummycell container cellbtn" style="justify-content: center; align-items: center; ">
                            <img src="assets/CamLockBoatIcon.png" alt=" " class="buccaneer icon ">
                        </div>
                        <div id="btnchancecards" class="dummycell container cellbtn" style="justify-content: center; align-items: center; ">
                            <img src="assets/CardIcon.png" alt=" " class="buccaneer icon ">
                            <div style="flex: 1"></div>
                            <div id="chancecardcount" class="cardcount ">6</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action buttons -->
            <div id="actionbtnwrapper" class="column" style=" ">
                <div class="row">
                    <!-- <div></div> -->
                    <!-- <div class="dbg3" style="flex: 1 1"></div> -->
                    <div id="cs" class="" style="display: inline-flex; flex-wrap: nowrap; flex: 1 0 auto; overflow:visible; width: 0; pointer-events: all; height: 200px; justify-content: center; overflow: hidden; align-items: flex-end;">
                        <div id="c1" class="cardimg"><img class="card" src="assets/pirates/Pirate Black 1 NoWear.png " alt=" "></div>
                        <div class="cardimg"><img class="card" src="assets/pirates/Pirate Black 3 NoWear.png " alt=" "></div>
                        <!-- <div style="width: 150px;"></div> -->
                        <div class="cardimg"><img class="card" src="assets/pirates/Pirate Red 1 NoWear.png " alt=" "></div>
                        <div class="cardimg"><img class="card" src="assets/pirates/Pirate Red 2 NoWear.png " alt=" "></div>
                        <div class="cardimg"><img class="card" src="assets/pirates/Pirate Red 2 NoWear.png " alt=" "></div>
                        <div class="cardimg"><img class="card" src="assets/pirates/Pirate Red 3 NoWear.png " alt=" "></div>
                        <div class="cardimg"><img class="card" src="assets/pirates/Pirate Red 3 NoWear.png " alt=" "></div>
                        <!-- <div style="flex: 0 0 80px;"></div> -->

                        <!-- <img class="card" src="assets/pirates/Pirate Red 3 NoWear.png " alt=" "> -->
                        <!-- </div> -->
                        <!-- 
                        <img class="card" src="assets/pirates/Pirate Red 3 NoWear.png " alt=" ">
                        <img class="card" src="assets/pirates/Pirate Red 3 NoWear.png " alt=" ">
                        <img class="card" src="assets/pirates/Pirate Red 3 NoWear.png " alt=" "> -->
                        <!-- </div> -->
                        <!-- <div class="card ">
                            <img src="assets/pirates/Pirate Red 3 NoWear.png " alt=" ">
                        </div>
                        <div class="card ">
                            <img src="assets/pirates/Pirate Red 3 NoWear.png " alt=" ">
                        </div>
                        <div class="card ">
                            <img src="assets/pirates/Pirate Red 3 NoWear.png " alt=" ">
                        </div> -->
                    </div>
                    <!-- <div class="dbg3" style="flex: 1 1"></div> -->
                </div>


                <div id="actionbtnwrapper2" class="row" style="z-index: 1; flex: 0 0 auto">
                    <div id="buttons" class="row ">
                        <div id="actionbtnturn" class="actionbtn " style="flex: 0 1; white-space: nowrap; ">END TURN</div>
                        <div id="actionbtnattacktrade" class="actionbtn disabled " style="flex: 0 1 ">ATTACK!</div>
                        <!-- <div style="flex: 1 1; max-width: 50px; min-width: 20px; "></div> -->
                        <!-- <div class="actionbtn disabled " style="flex: 0 1 ">TRADE</div> -->
                    </div>
                </div>
            </div>

            <!-- Minimap -->
            <div id="minimapwrapper" class="row " style="z-index: 1; flex: 1 1; /*height: 300px;*/ justify-content: flex-end; align-items: flex-end; ">
                <div id="hudright" class=" " style="background-color: darkred; max-width: fit-content; max-height: fit-content; ">
                    <canvas id="minimap" class="clickable minimap " style="position: absolute; "></canvas>
                    <img class="minimap" src="assets/MiniBoard_NoBorder.png " alt=" " style=" ">
                </div>
            </div>
        </div>
    </div>

    <div id="popup" class="container" style="display:none; position: fixed; left: 0; right: 0; top: 0; bottom: 0; flex-direction: column; overflow: auto; background-color: rgba(0, 0, 0, 0.5); ">
        <div class="popup container clickable" style="flex: 1 1 auto; align-items: center; padding: 20px; flex-direction: column; justify-content: center; ">
            <!-- <div style=" "> -->
            <!-- <div style="flex: 1 1 0 "></div> -->
            <img id="chancecard" src="assets/cards/Chance 1.png " alt=" " style="flex: 1 1 0; min-height: 000px; max-height: 500px; object-fit: contain; display: block; ">
            <!-- </div> -->
            <!-- <div style="background-color: darkred; width: 100%; flex: 1 1 0; "></div> -->
            <div id="btnClosePopup" class="btn " style="flex: 0 1; ">CLOSE</div>
        </div>
    </div>

    <div id="rules" class="row" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); justify-content: center; pointer-events: all;">
        <div class="" style="font-family: pirate; font-size: 1.5em; max-width: 1500px; text-align: justify; padding: 30px; overflow: auto; background-color: blanchedalmond;">
            <p style="text-align: center; font-weight: bold; font-size: larger;">RULES</p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vel mattis felis. Etiam consequat nisi ut est posuere, id laoreet odio pulvinar. Nam id interdum ante, vel hendrerit nulla. Fusce sit amet dolor in neque rhoncus ullamcorper in ultrices metus.
            In maximus consectetur nulla quis finibus. Fusce ullamcorper purus suscipit ante ultrices pellentesque. Proin et tempor mauris. Suspendisse nec venenatis turpis. Ut laoreet sit amet enim ac tincidunt. Maecenas ornare consectetur odio, a blandit
            tortor dignissim vitae. Morbi eu nibh cursus, accumsan mi eget, porttitor odio. Praesent et leo ut odio sagittis iaculis non et ex. Nam eleifend consequat ligula et porta. Donec semper ullamcorper mi tincidunt luctus. Quisque ultrices ante
            nec urna elementum vestibulum. Quisque ut lectus magna. Donec lacinia, nulla quis scelerisque consequat, sem tellus euismod nunc, eu molestie nisl ante a sem. Mauris vehicula lectus nec porta interdum. Integer sollicitudin condimentum turpis
            sit amet fermentum. Sed a nisl purus. Proin ut augue at quam lacinia suscipit nec nec augue. Sed tempor vulputate lorem, gravida sagittis nibh egestas vitae. Pellentesque vitae lacus augue. Aliquam iaculis consequat vestibulum. Duis fringilla
            malesuada felis, eu dapibus nisl aliquam eu. Maecenas ipsum ligula, congue sed rutrum placerat, rhoncus et ante. Suspendisse tempus lacus sit amet velit tristique tincidunt. In fringilla vestibulum augue, at tincidunt ex molestie ac. Ut pretium
            nibh id nulla vehicula, vel sodales quam molestie. Vestibulum vitae sapien risus. Nulla facilisi. Praesent rhoncus, enim quis mattis hendrerit, nulla neque sollicitudin ante, ut scelerisque mauris arcu at dolor. Nunc sagittis ultricies arcu
            et sollicitudin. Aliquam eleifend justo ac dui viverra tincidunt. Morbi vel molestie sapien, ac sollicitudin ipsum. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. In aliquam eros eget gravida tincidunt.
            Praesent vulputate metus vel velit convallis blandit. Nam sed nisl id lorem lacinia ullamcorper at quis est. Nam faucibus hendrerit dolor. In libero neque, molestie consectetur convallis ut, blandit id mauris. Aenean ultrices mauris non dapibus
            mattis. Nullam venenatis accumsan vulputate. Curabitur eu interdum justo, non interdum nunc. Donec porttitor euismod eros, ut fringilla ligula varius in. Proin eu mauris luctus, semper dolor a, pharetra ex. Vestibulum vel augue rhoncus, volutpat
            lorem non, fermentum tortor. Sed eget sem nec diam commodo auctor vitae sit amet lectus. Aliquam erat volutpat. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Cras tempus tellus quam, at commodo
            libero malesuada sed. Fusce ac aliquet arcu. Proin luctus massa nec mi commodo, ac bibendum purus venenatis. Vivamus lobortis lorem eu ligula commodo hendrerit. Nulla consequat tempus ullamcorper. Nulla et augue finibus elit pulvinar ornare.
            Phasellus suscipit sapien est, id tempor ipsum tempor eget. Mauris sit amet tincidunt orci. Donec pretium nisi ut eros ultrices dapibus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Lorem ipsum
            dolor sit amet, consectetur adipiscing elit. Etiam vel mattis felis. Etiam consequat nisi ut est posuere, id laoreet odio pulvinar. Nam id interdum ante, vel hendrerit nulla. Fusce sit amet dolor in neque rhoncus ullamcorper in ultrices metus.
            In maximus consectetur nulla quis finibus. Fusce ullamcorper purus suscipit ante ultrices pellentesque. Proin et tempor mauris. Suspendisse nec venenatis turpis. Ut laoreet sit amet enim ac tincidunt. Maecenas ornare consectetur odio, a blandit
            tortor dignissim vitae. Morbi eu nibh cursus, accumsan mi eget, porttitor odio. Praesent et leo ut odio sagittis iaculis non et ex. Nam eleifend consequat ligula et porta. Donec semper ullamcorper mi tincidunt luctus. Quisque ultrices ante
            nec urna elementum vestibulum. Quisque ut lectus magna. Donec lacinia, nulla quis scelerisque consequat, sem tellus euismod nunc, eu molestie nisl ante a sem. Mauris vehicula lectus nec porta interdum. Integer sollicitudin condimentum turpis
            sit amet fermentum. Sed a nisl purus. Proin ut augue at quam lacinia suscipit nec nec augue. Sed tempor vulputate lorem, gravida sagittis nibh egestas vitae. Pellentesque vitae lacus augue. Aliquam iaculis consequat vestibulum. Duis fringilla
            malesuada felis, eu dapibus nisl aliquam eu. Maecenas ipsum ligula, congue sed rutrum placerat, rhoncus et ante. Suspendisse tempus lacus sit amet velit tristique tincidunt. In fringilla vestibulum augue, at tincidunt ex molestie ac. Ut pretium
            nibh id nulla vehicula, vel sodales quam molestie. Vestibulum vitae sapien risus. Nulla facilisi. Praesent rhoncus, enim quis mattis hendrerit, nulla neque sollicitudin ante, ut scelerisque mauris arcu at dolor. Nunc sagittis ultricies arcu
            et sollicitudin. Aliquam eleifend justo ac dui viverra tincidunt. Morbi vel molestie sapien, ac sollicitudin ipsum. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. In aliquam eros eget gravida tincidunt.
            Praesent vulputate metus vel velit convallis blandit. Nam sed nisl id lorem lacinia ullamcorper at quis est. Nam faucibus hendrerit dolor. In libero neque, molestie consectetur convallis ut, blandit id mauris. Aenean ultrices mauris non dapibus
            mattis. Nullam venenatis accumsan vulputate. Curabitur eu interdum justo, non interdum nunc. Donec porttitor euismod eros, ut fringilla ligula varius in. Proin eu mauris luctus, semper dolor a, pharetra ex. Vestibulum vel augue rhoncus, volutpat
            lorem non, fermentum tortor. Sed eget sem nec diam commodo auctor vitae sit amet lectus. Aliquam erat volutpat. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Cras tempus tellus quam, at commodo
            libero malesuada sed. Fusce ac aliquet arcu. Proin luctus massa nec mi commodo, ac bibendum purus venenatis. Vivamus lobortis lorem eu ligula commodo hendrerit. Nulla consequat tempus ullamcorper. Nulla et augue finibus elit pulvinar ornare.
            Phasellus suscipit sapien est, id tempor ipsum tempor eget. Mauris sit amet tincidunt orci. Donec pretium nisi ut eros ultrices dapibus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.
        </div>
    </div>

    <div class="container" style="display: none; position: absolute; top: 0; bottom: 0; left: 0; right: 0; justify-content: center; align-items: center;">
        <div class="row" style="width: calc(100vw - 100px); height: calc(100vh - 100px); ">
            <div class="dbg1" style="flex: 1 1"></div>

            <div class="dbg2 column" style="flex: 0 1 100px; justify-content: center;">
                <div class="dbg4 tradebtn"><i class="fa fa-arrow-left" style="padding-left: 5px;"></i></div>
                <div class="dbg4 tradebtn"><i class="fa fa-arrow-right" style="padding-left: 5px;"></i></div>
            </div>

            <div class="dbg3" style="flex: 1 1"></div>

        </div>
    </div>



    <div id="loadingcover" style="z-index: 100; position: absolute; top: 0; bottom: 0; left: 0; right: 0; pointer-events: none; overflow: hidden; background-color: black;"></div>

    <script src="main.js "></script>
</body>

</html>